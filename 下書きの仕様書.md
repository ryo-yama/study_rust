# リズムゲーム仕様書 (TUI 版 太鼓の達人)

## 1. ゲーム概要

* 太鼓の達人を TUI (Terminal User Interface) で再現したリズムゲーム
* PC キーボードを使用して、音楽に合わせてノーツを叩く
* 太鼓さん次郎形式の譜面データ (`.tja` ファイル) を使用

## 2. ゲーム仕様

### 2.1. 基本仕様

* **ゲームジャンル**: リズムゲーム (太鼓の達人)
* **操作方法**:
    * 赤ノーツ: D, J キー
    * 青ノーツ: S, K キー
* **画面構成**:
    * ノーツの形状: "■"
    * その他: スコア、コンボ、速度などの情報は後ほど決定
* **楽曲**: 太鼓さん次郎形式の譜面データ (`.tja` ファイル) を使用

### 2.2. 技術仕様

* **GUI 制御**:
    * TUI ライブラリ: Ratatui
    * 画面レイアウト: Layout, Constraint を使用
    * ウィジェット: Block, Paragraph などを使用
    * イベント処理: キーボード入力、画面更新
* **譜面/音楽データ管理**:
    * 譜面データ: `.tja` ファイルの読み込み、解析
    * 音楽データ: `rodio` クレートなどを使用して再生
    * 譜面データと音楽データの同期
* **ノーツ判定処理**:
    * ノーツの判定: 判定ラインとの距離、タイミングに基づいて判定
    * スコア計算: 判定結果、コンボ数などに基づいて計算
    * コンボ、ライフの管理

### 2.3. アーキテクチャ

* **GUI 制御部分**:
    * 画面表示、ユーザー入力処理を担当
* **譜面/音楽データ管理**:
    * `.tja` ファイルの読み込み、解析、楽曲データの管理
    * 楽曲の再生、停止、タイミング制御
* **ノーツ判定処理**:
    * ユーザーの入力タイミングとノーツのタイミングを比較し、判定
    * スコア計算、コンボ、ライフなどのゲームロジックを担当
* **設定管理**:
    * ゲームの設定（キー割り当て、音量、難易度など）を管理
* **データ管理**:
    * リプレイデータ、スコアランキングなどのデータを管理
* **AI 譜面生成 (将来的な機能)**:
    * AI を活用して自動で譜面を生成

## 3. 開発環境

* **プログラミング言語**: Rust
* **TUI ライブラリ**: Ratatui
* **音楽再生ライブラリ**: rodio (予定)

## 4. 開発計画

1.  太鼓さん次郎形式の譜面データ解析
2.  楽曲再生機能の実装
3.  ノーツの表示、キー入力処理の実装
4.  判定、スコア計算、コンボ、ライフの実装
5.  画面レイアウト、情報表示の実装
6.  ゲーム全体の調整、デバッグ
7.  機能追加、改善

## 5. 今後の課題

* スコア、コンボ、速度などの情報表示の実装
* ゲーム設定機能の実装
* リプレイ機能、スコアランキング機能の実装
* AI 譜面生成機能の実装 (将来的な課題)

---

この仕様書は、現時点での開発計画に基づいて作成されています。今後、開発状況や仕様変更に応じて、随時更新される可能性があります。
